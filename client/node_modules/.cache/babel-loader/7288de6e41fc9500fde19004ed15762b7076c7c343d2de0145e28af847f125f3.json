{"ast":null,"code":"import { importJWK } from '../key/import.js';\nimport { JWKSInvalid, JOSENotSupported, JWKSNoMatchingKey, JWKSMultipleMatchingKeys } from '../util/errors.js';\nimport isObject from '../lib/is_object.js';\nfunction getKtyFromAlg(alg) {\n  switch (typeof alg === 'string' && alg.slice(0, 2)) {\n    case 'RS':\n    case 'PS':\n      return 'RSA';\n    case 'ES':\n      return 'EC';\n    case 'Ed':\n      return 'OKP';\n    default:\n      throw new JOSENotSupported('Unsupported \"alg\" value for a JSON Web Key Set');\n  }\n}\nexport function isJWKSLike(jwks) {\n  return jwks && typeof jwks === 'object' && Array.isArray(jwks.keys) && jwks.keys.every(isJWKLike);\n}\nfunction isJWKLike(key) {\n  return isObject(key);\n}\nfunction clone(obj) {\n  if (typeof structuredClone === 'function') {\n    return structuredClone(obj);\n  }\n  return JSON.parse(JSON.stringify(obj));\n}\nexport class LocalJWKSet {\n  constructor(jwks) {\n    this._cached = new WeakMap();\n    if (!isJWKSLike(jwks)) {\n      throw new JWKSInvalid('JSON Web Key Set malformed');\n    }\n    this._jwks = clone(jwks);\n  }\n  async getKey(protectedHeader, token) {\n    const {\n      alg,\n      kid\n    } = {\n      ...protectedHeader,\n      ...(token === null || token === void 0 ? void 0 : token.header)\n    };\n    const kty = getKtyFromAlg(alg);\n    const candidates = this._jwks.keys.filter(jwk => {\n      let candidate = kty === jwk.kty;\n      if (candidate && typeof kid === 'string') {\n        candidate = kid === jwk.kid;\n      }\n      if (candidate && typeof jwk.alg === 'string') {\n        candidate = alg === jwk.alg;\n      }\n      if (candidate && typeof jwk.use === 'string') {\n        candidate = jwk.use === 'sig';\n      }\n      if (candidate && Array.isArray(jwk.key_ops)) {\n        candidate = jwk.key_ops.includes('verify');\n      }\n      if (candidate && alg === 'EdDSA') {\n        candidate = jwk.crv === 'Ed25519' || jwk.crv === 'Ed448';\n      }\n      if (candidate) {\n        switch (alg) {\n          case 'ES256':\n            candidate = jwk.crv === 'P-256';\n            break;\n          case 'ES256K':\n            candidate = jwk.crv === 'secp256k1';\n            break;\n          case 'ES384':\n            candidate = jwk.crv === 'P-384';\n            break;\n          case 'ES512':\n            candidate = jwk.crv === 'P-521';\n            break;\n        }\n      }\n      return candidate;\n    });\n    const {\n      0: jwk,\n      length\n    } = candidates;\n    if (length === 0) {\n      throw new JWKSNoMatchingKey();\n    } else if (length !== 1) {\n      const error = new JWKSMultipleMatchingKeys();\n      const {\n        _cached\n      } = this;\n      error[Symbol.asyncIterator] = async function* () {\n        for (const jwk of candidates) {\n          try {\n            yield await importWithAlgCache(_cached, jwk, alg);\n          } catch (_a) {\n            continue;\n          }\n        }\n      };\n      throw error;\n    }\n    return importWithAlgCache(this._cached, jwk, alg);\n  }\n}\nasync function importWithAlgCache(cache, jwk, alg) {\n  const cached = cache.get(jwk) || cache.set(jwk, {}).get(jwk);\n  if (cached[alg] === undefined) {\n    const key = await importJWK({\n      ...jwk,\n      ext: true\n    }, alg);\n    if (key instanceof Uint8Array || key.type !== 'public') {\n      throw new JWKSInvalid('JSON Web Key Set members must be public keys');\n    }\n    cached[alg] = key;\n  }\n  return cached[alg];\n}\nexport function createLocalJWKSet(jwks) {\n  const set = new LocalJWKSet(jwks);\n  return async function (protectedHeader, token) {\n    return set.getKey(protectedHeader, token);\n  };\n}","map":{"version":3,"names":["importJWK","JWKSInvalid","JOSENotSupported","JWKSNoMatchingKey","JWKSMultipleMatchingKeys","isObject","getKtyFromAlg","alg","slice","isJWKSLike","jwks","Array","isArray","keys","every","isJWKLike","key","clone","obj","structuredClone","JSON","parse","stringify","LocalJWKSet","constructor","_cached","WeakMap","_jwks","getKey","protectedHeader","token","kid","header","kty","candidates","filter","jwk","candidate","use","key_ops","includes","crv","length","error","Symbol","asyncIterator","importWithAlgCache","_a","cache","cached","get","set","undefined","ext","Uint8Array","type","createLocalJWKSet"],"sources":["C:/Users/rama_/Desktop/vicky uni/Henrry Prep Course/otrom2/Brainly-Front/client/node_modules/jose/dist/browser/jwks/local.js"],"sourcesContent":["import { importJWK } from '../key/import.js';\nimport { JWKSInvalid, JOSENotSupported, JWKSNoMatchingKey, JWKSMultipleMatchingKeys, } from '../util/errors.js';\nimport isObject from '../lib/is_object.js';\nfunction getKtyFromAlg(alg) {\n    switch (typeof alg === 'string' && alg.slice(0, 2)) {\n        case 'RS':\n        case 'PS':\n            return 'RSA';\n        case 'ES':\n            return 'EC';\n        case 'Ed':\n            return 'OKP';\n        default:\n            throw new JOSENotSupported('Unsupported \"alg\" value for a JSON Web Key Set');\n    }\n}\nexport function isJWKSLike(jwks) {\n    return (jwks &&\n        typeof jwks === 'object' &&\n        Array.isArray(jwks.keys) &&\n        jwks.keys.every(isJWKLike));\n}\nfunction isJWKLike(key) {\n    return isObject(key);\n}\nfunction clone(obj) {\n    if (typeof structuredClone === 'function') {\n        return structuredClone(obj);\n    }\n    return JSON.parse(JSON.stringify(obj));\n}\nexport class LocalJWKSet {\n    constructor(jwks) {\n        this._cached = new WeakMap();\n        if (!isJWKSLike(jwks)) {\n            throw new JWKSInvalid('JSON Web Key Set malformed');\n        }\n        this._jwks = clone(jwks);\n    }\n    async getKey(protectedHeader, token) {\n        const { alg, kid } = { ...protectedHeader, ...token === null || token === void 0 ? void 0 : token.header };\n        const kty = getKtyFromAlg(alg);\n        const candidates = this._jwks.keys.filter((jwk) => {\n            let candidate = kty === jwk.kty;\n            if (candidate && typeof kid === 'string') {\n                candidate = kid === jwk.kid;\n            }\n            if (candidate && typeof jwk.alg === 'string') {\n                candidate = alg === jwk.alg;\n            }\n            if (candidate && typeof jwk.use === 'string') {\n                candidate = jwk.use === 'sig';\n            }\n            if (candidate && Array.isArray(jwk.key_ops)) {\n                candidate = jwk.key_ops.includes('verify');\n            }\n            if (candidate && alg === 'EdDSA') {\n                candidate = jwk.crv === 'Ed25519' || jwk.crv === 'Ed448';\n            }\n            if (candidate) {\n                switch (alg) {\n                    case 'ES256':\n                        candidate = jwk.crv === 'P-256';\n                        break;\n                    case 'ES256K':\n                        candidate = jwk.crv === 'secp256k1';\n                        break;\n                    case 'ES384':\n                        candidate = jwk.crv === 'P-384';\n                        break;\n                    case 'ES512':\n                        candidate = jwk.crv === 'P-521';\n                        break;\n                }\n            }\n            return candidate;\n        });\n        const { 0: jwk, length } = candidates;\n        if (length === 0) {\n            throw new JWKSNoMatchingKey();\n        }\n        else if (length !== 1) {\n            const error = new JWKSMultipleMatchingKeys();\n            const { _cached } = this;\n            error[Symbol.asyncIterator] = async function* () {\n                for (const jwk of candidates) {\n                    try {\n                        yield await importWithAlgCache(_cached, jwk, alg);\n                    }\n                    catch (_a) {\n                        continue;\n                    }\n                }\n            };\n            throw error;\n        }\n        return importWithAlgCache(this._cached, jwk, alg);\n    }\n}\nasync function importWithAlgCache(cache, jwk, alg) {\n    const cached = cache.get(jwk) || cache.set(jwk, {}).get(jwk);\n    if (cached[alg] === undefined) {\n        const key = await importJWK({ ...jwk, ext: true }, alg);\n        if (key instanceof Uint8Array || key.type !== 'public') {\n            throw new JWKSInvalid('JSON Web Key Set members must be public keys');\n        }\n        cached[alg] = key;\n    }\n    return cached[alg];\n}\nexport function createLocalJWKSet(jwks) {\n    const set = new LocalJWKSet(jwks);\n    return async function (protectedHeader, token) {\n        return set.getKey(protectedHeader, token);\n    };\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}