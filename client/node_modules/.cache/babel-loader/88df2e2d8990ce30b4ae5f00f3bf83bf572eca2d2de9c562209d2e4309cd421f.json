{"ast":null,"code":"import { CompactEncrypt } from '../jwe/compact/encrypt.js';\nimport { encoder } from '../lib/buffer_utils.js';\nimport { ProduceJWT } from './produce.js';\nexport class EncryptJWT extends ProduceJWT {\n  setProtectedHeader(protectedHeader) {\n    if (this._protectedHeader) {\n      throw new TypeError('setProtectedHeader can only be called once');\n    }\n    this._protectedHeader = protectedHeader;\n    return this;\n  }\n  setKeyManagementParameters(parameters) {\n    if (this._keyManagementParameters) {\n      throw new TypeError('setKeyManagementParameters can only be called once');\n    }\n    this._keyManagementParameters = parameters;\n    return this;\n  }\n  setContentEncryptionKey(cek) {\n    if (this._cek) {\n      throw new TypeError('setContentEncryptionKey can only be called once');\n    }\n    this._cek = cek;\n    return this;\n  }\n  setInitializationVector(iv) {\n    if (this._iv) {\n      throw new TypeError('setInitializationVector can only be called once');\n    }\n    this._iv = iv;\n    return this;\n  }\n  replicateIssuerAsHeader() {\n    this._replicateIssuerAsHeader = true;\n    return this;\n  }\n  replicateSubjectAsHeader() {\n    this._replicateSubjectAsHeader = true;\n    return this;\n  }\n  replicateAudienceAsHeader() {\n    this._replicateAudienceAsHeader = true;\n    return this;\n  }\n  async encrypt(key, options) {\n    const enc = new CompactEncrypt(encoder.encode(JSON.stringify(this._payload)));\n    if (this._replicateIssuerAsHeader) {\n      this._protectedHeader = {\n        ...this._protectedHeader,\n        iss: this._payload.iss\n      };\n    }\n    if (this._replicateSubjectAsHeader) {\n      this._protectedHeader = {\n        ...this._protectedHeader,\n        sub: this._payload.sub\n      };\n    }\n    if (this._replicateAudienceAsHeader) {\n      this._protectedHeader = {\n        ...this._protectedHeader,\n        aud: this._payload.aud\n      };\n    }\n    enc.setProtectedHeader(this._protectedHeader);\n    if (this._iv) {\n      enc.setInitializationVector(this._iv);\n    }\n    if (this._cek) {\n      enc.setContentEncryptionKey(this._cek);\n    }\n    if (this._keyManagementParameters) {\n      enc.setKeyManagementParameters(this._keyManagementParameters);\n    }\n    return enc.encrypt(key, options);\n  }\n}","map":{"version":3,"names":["CompactEncrypt","encoder","ProduceJWT","EncryptJWT","setProtectedHeader","protectedHeader","_protectedHeader","TypeError","setKeyManagementParameters","parameters","_keyManagementParameters","setContentEncryptionKey","cek","_cek","setInitializationVector","iv","_iv","replicateIssuerAsHeader","_replicateIssuerAsHeader","replicateSubjectAsHeader","_replicateSubjectAsHeader","replicateAudienceAsHeader","_replicateAudienceAsHeader","encrypt","key","options","enc","encode","JSON","stringify","_payload","iss","sub","aud"],"sources":["C:/Users/rama_/Desktop/vicky uni/Henrry Prep Course/otrom2/Brainly-Front/client/node_modules/jose/dist/browser/jwt/encrypt.js"],"sourcesContent":["import { CompactEncrypt } from '../jwe/compact/encrypt.js';\nimport { encoder } from '../lib/buffer_utils.js';\nimport { ProduceJWT } from './produce.js';\nexport class EncryptJWT extends ProduceJWT {\n    setProtectedHeader(protectedHeader) {\n        if (this._protectedHeader) {\n            throw new TypeError('setProtectedHeader can only be called once');\n        }\n        this._protectedHeader = protectedHeader;\n        return this;\n    }\n    setKeyManagementParameters(parameters) {\n        if (this._keyManagementParameters) {\n            throw new TypeError('setKeyManagementParameters can only be called once');\n        }\n        this._keyManagementParameters = parameters;\n        return this;\n    }\n    setContentEncryptionKey(cek) {\n        if (this._cek) {\n            throw new TypeError('setContentEncryptionKey can only be called once');\n        }\n        this._cek = cek;\n        return this;\n    }\n    setInitializationVector(iv) {\n        if (this._iv) {\n            throw new TypeError('setInitializationVector can only be called once');\n        }\n        this._iv = iv;\n        return this;\n    }\n    replicateIssuerAsHeader() {\n        this._replicateIssuerAsHeader = true;\n        return this;\n    }\n    replicateSubjectAsHeader() {\n        this._replicateSubjectAsHeader = true;\n        return this;\n    }\n    replicateAudienceAsHeader() {\n        this._replicateAudienceAsHeader = true;\n        return this;\n    }\n    async encrypt(key, options) {\n        const enc = new CompactEncrypt(encoder.encode(JSON.stringify(this._payload)));\n        if (this._replicateIssuerAsHeader) {\n            this._protectedHeader = { ...this._protectedHeader, iss: this._payload.iss };\n        }\n        if (this._replicateSubjectAsHeader) {\n            this._protectedHeader = { ...this._protectedHeader, sub: this._payload.sub };\n        }\n        if (this._replicateAudienceAsHeader) {\n            this._protectedHeader = { ...this._protectedHeader, aud: this._payload.aud };\n        }\n        enc.setProtectedHeader(this._protectedHeader);\n        if (this._iv) {\n            enc.setInitializationVector(this._iv);\n        }\n        if (this._cek) {\n            enc.setContentEncryptionKey(this._cek);\n        }\n        if (this._keyManagementParameters) {\n            enc.setKeyManagementParameters(this._keyManagementParameters);\n        }\n        return enc.encrypt(key, options);\n    }\n}\n"],"mappings":"AAAA,SAASA,cAAc,QAAQ,2BAA2B;AAC1D,SAASC,OAAO,QAAQ,wBAAwB;AAChD,SAASC,UAAU,QAAQ,cAAc;AACzC,OAAO,MAAMC,UAAU,SAASD,UAAU,CAAC;EACvCE,kBAAkBA,CAACC,eAAe,EAAE;IAChC,IAAI,IAAI,CAACC,gBAAgB,EAAE;MACvB,MAAM,IAAIC,SAAS,CAAC,4CAA4C,CAAC;IACrE;IACA,IAAI,CAACD,gBAAgB,GAAGD,eAAe;IACvC,OAAO,IAAI;EACf;EACAG,0BAA0BA,CAACC,UAAU,EAAE;IACnC,IAAI,IAAI,CAACC,wBAAwB,EAAE;MAC/B,MAAM,IAAIH,SAAS,CAAC,oDAAoD,CAAC;IAC7E;IACA,IAAI,CAACG,wBAAwB,GAAGD,UAAU;IAC1C,OAAO,IAAI;EACf;EACAE,uBAAuBA,CAACC,GAAG,EAAE;IACzB,IAAI,IAAI,CAACC,IAAI,EAAE;MACX,MAAM,IAAIN,SAAS,CAAC,iDAAiD,CAAC;IAC1E;IACA,IAAI,CAACM,IAAI,GAAGD,GAAG;IACf,OAAO,IAAI;EACf;EACAE,uBAAuBA,CAACC,EAAE,EAAE;IACxB,IAAI,IAAI,CAACC,GAAG,EAAE;MACV,MAAM,IAAIT,SAAS,CAAC,iDAAiD,CAAC;IAC1E;IACA,IAAI,CAACS,GAAG,GAAGD,EAAE;IACb,OAAO,IAAI;EACf;EACAE,uBAAuBA,CAAA,EAAG;IACtB,IAAI,CAACC,wBAAwB,GAAG,IAAI;IACpC,OAAO,IAAI;EACf;EACAC,wBAAwBA,CAAA,EAAG;IACvB,IAAI,CAACC,yBAAyB,GAAG,IAAI;IACrC,OAAO,IAAI;EACf;EACAC,yBAAyBA,CAAA,EAAG;IACxB,IAAI,CAACC,0BAA0B,GAAG,IAAI;IACtC,OAAO,IAAI;EACf;EACA,MAAMC,OAAOA,CAACC,GAAG,EAAEC,OAAO,EAAE;IACxB,MAAMC,GAAG,GAAG,IAAI1B,cAAc,CAACC,OAAO,CAAC0B,MAAM,CAACC,IAAI,CAACC,SAAS,CAAC,IAAI,CAACC,QAAQ,CAAC,CAAC,CAAC;IAC7E,IAAI,IAAI,CAACZ,wBAAwB,EAAE;MAC/B,IAAI,CAACZ,gBAAgB,GAAG;QAAE,GAAG,IAAI,CAACA,gBAAgB;QAAEyB,GAAG,EAAE,IAAI,CAACD,QAAQ,CAACC;MAAI,CAAC;IAChF;IACA,IAAI,IAAI,CAACX,yBAAyB,EAAE;MAChC,IAAI,CAACd,gBAAgB,GAAG;QAAE,GAAG,IAAI,CAACA,gBAAgB;QAAE0B,GAAG,EAAE,IAAI,CAACF,QAAQ,CAACE;MAAI,CAAC;IAChF;IACA,IAAI,IAAI,CAACV,0BAA0B,EAAE;MACjC,IAAI,CAAChB,gBAAgB,GAAG;QAAE,GAAG,IAAI,CAACA,gBAAgB;QAAE2B,GAAG,EAAE,IAAI,CAACH,QAAQ,CAACG;MAAI,CAAC;IAChF;IACAP,GAAG,CAACtB,kBAAkB,CAAC,IAAI,CAACE,gBAAgB,CAAC;IAC7C,IAAI,IAAI,CAACU,GAAG,EAAE;MACVU,GAAG,CAACZ,uBAAuB,CAAC,IAAI,CAACE,GAAG,CAAC;IACzC;IACA,IAAI,IAAI,CAACH,IAAI,EAAE;MACXa,GAAG,CAACf,uBAAuB,CAAC,IAAI,CAACE,IAAI,CAAC;IAC1C;IACA,IAAI,IAAI,CAACH,wBAAwB,EAAE;MAC/BgB,GAAG,CAAClB,0BAA0B,CAAC,IAAI,CAACE,wBAAwB,CAAC;IACjE;IACA,OAAOgB,GAAG,CAACH,OAAO,CAACC,GAAG,EAAEC,OAAO,CAAC;EACpC;AACJ"},"metadata":{},"sourceType":"module","externalDependencies":[]}