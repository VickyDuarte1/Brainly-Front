{"ast":null,"code":"import { withAlg as invalidKeyInput } from './invalid_key_input.js';\nimport isKeyLike, { types } from '../runtime/is_key_like.js';\nconst symmetricTypeCheck = (alg, key) => {\n  if (key instanceof Uint8Array) return;\n  if (!isKeyLike(key)) {\n    throw new TypeError(invalidKeyInput(alg, key, ...types, 'Uint8Array'));\n  }\n  if (key.type !== 'secret') {\n    throw new TypeError(`${types.join(' or ')} instances for symmetric algorithms must be of type \"secret\"`);\n  }\n};\nconst asymmetricTypeCheck = (alg, key, usage) => {\n  if (!isKeyLike(key)) {\n    throw new TypeError(invalidKeyInput(alg, key, ...types));\n  }\n  if (key.type === 'secret') {\n    throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithms must not be of type \"secret\"`);\n  }\n  if (usage === 'sign' && key.type === 'public') {\n    throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm signing must be of type \"private\"`);\n  }\n  if (usage === 'decrypt' && key.type === 'public') {\n    throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm decryption must be of type \"private\"`);\n  }\n  if (key.algorithm && usage === 'verify' && key.type === 'private') {\n    throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm verifying must be of type \"public\"`);\n  }\n  if (key.algorithm && usage === 'encrypt' && key.type === 'private') {\n    throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm encryption must be of type \"public\"`);\n  }\n};\nconst checkKeyType = (alg, key, usage) => {\n  const symmetric = alg.startsWith('HS') || alg === 'dir' || alg.startsWith('PBES2') || /^A\\d{3}(?:GCM)?KW$/.test(alg);\n  if (symmetric) {\n    symmetricTypeCheck(alg, key);\n  } else {\n    asymmetricTypeCheck(alg, key, usage);\n  }\n};\nexport default checkKeyType;","map":{"version":3,"names":["withAlg","invalidKeyInput","isKeyLike","types","symmetricTypeCheck","alg","key","Uint8Array","TypeError","type","join","asymmetricTypeCheck","usage","algorithm","checkKeyType","symmetric","startsWith","test"],"sources":["C:/Users/rama_/Desktop/vicky uni/Henrry Prep Course/otrom2/Brainly-Front/client/node_modules/jose/dist/browser/lib/check_key_type.js"],"sourcesContent":["import { withAlg as invalidKeyInput } from './invalid_key_input.js';\nimport isKeyLike, { types } from '../runtime/is_key_like.js';\nconst symmetricTypeCheck = (alg, key) => {\n    if (key instanceof Uint8Array)\n        return;\n    if (!isKeyLike(key)) {\n        throw new TypeError(invalidKeyInput(alg, key, ...types, 'Uint8Array'));\n    }\n    if (key.type !== 'secret') {\n        throw new TypeError(`${types.join(' or ')} instances for symmetric algorithms must be of type \"secret\"`);\n    }\n};\nconst asymmetricTypeCheck = (alg, key, usage) => {\n    if (!isKeyLike(key)) {\n        throw new TypeError(invalidKeyInput(alg, key, ...types));\n    }\n    if (key.type === 'secret') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithms must not be of type \"secret\"`);\n    }\n    if (usage === 'sign' && key.type === 'public') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm signing must be of type \"private\"`);\n    }\n    if (usage === 'decrypt' && key.type === 'public') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm decryption must be of type \"private\"`);\n    }\n    if (key.algorithm && usage === 'verify' && key.type === 'private') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm verifying must be of type \"public\"`);\n    }\n    if (key.algorithm && usage === 'encrypt' && key.type === 'private') {\n        throw new TypeError(`${types.join(' or ')} instances for asymmetric algorithm encryption must be of type \"public\"`);\n    }\n};\nconst checkKeyType = (alg, key, usage) => {\n    const symmetric = alg.startsWith('HS') ||\n        alg === 'dir' ||\n        alg.startsWith('PBES2') ||\n        /^A\\d{3}(?:GCM)?KW$/.test(alg);\n    if (symmetric) {\n        symmetricTypeCheck(alg, key);\n    }\n    else {\n        asymmetricTypeCheck(alg, key, usage);\n    }\n};\nexport default checkKeyType;\n"],"mappings":"AAAA,SAASA,OAAO,IAAIC,eAAe,QAAQ,wBAAwB;AACnE,OAAOC,SAAS,IAAIC,KAAK,QAAQ,2BAA2B;AAC5D,MAAMC,kBAAkB,GAAGA,CAACC,GAAG,EAAEC,GAAG,KAAK;EACrC,IAAIA,GAAG,YAAYC,UAAU,EACzB;EACJ,IAAI,CAACL,SAAS,CAACI,GAAG,CAAC,EAAE;IACjB,MAAM,IAAIE,SAAS,CAACP,eAAe,CAACI,GAAG,EAAEC,GAAG,EAAE,GAAGH,KAAK,EAAE,YAAY,CAAC,CAAC;EAC1E;EACA,IAAIG,GAAG,CAACG,IAAI,KAAK,QAAQ,EAAE;IACvB,MAAM,IAAID,SAAS,CAAE,GAAEL,KAAK,CAACO,IAAI,CAAC,MAAM,CAAE,8DAA6D,CAAC;EAC5G;AACJ,CAAC;AACD,MAAMC,mBAAmB,GAAGA,CAACN,GAAG,EAAEC,GAAG,EAAEM,KAAK,KAAK;EAC7C,IAAI,CAACV,SAAS,CAACI,GAAG,CAAC,EAAE;IACjB,MAAM,IAAIE,SAAS,CAACP,eAAe,CAACI,GAAG,EAAEC,GAAG,EAAE,GAAGH,KAAK,CAAC,CAAC;EAC5D;EACA,IAAIG,GAAG,CAACG,IAAI,KAAK,QAAQ,EAAE;IACvB,MAAM,IAAID,SAAS,CAAE,GAAEL,KAAK,CAACO,IAAI,CAAC,MAAM,CAAE,mEAAkE,CAAC;EACjH;EACA,IAAIE,KAAK,KAAK,MAAM,IAAIN,GAAG,CAACG,IAAI,KAAK,QAAQ,EAAE;IAC3C,MAAM,IAAID,SAAS,CAAE,GAAEL,KAAK,CAACO,IAAI,CAAC,MAAM,CAAE,uEAAsE,CAAC;EACrH;EACA,IAAIE,KAAK,KAAK,SAAS,IAAIN,GAAG,CAACG,IAAI,KAAK,QAAQ,EAAE;IAC9C,MAAM,IAAID,SAAS,CAAE,GAAEL,KAAK,CAACO,IAAI,CAAC,MAAM,CAAE,0EAAyE,CAAC;EACxH;EACA,IAAIJ,GAAG,CAACO,SAAS,IAAID,KAAK,KAAK,QAAQ,IAAIN,GAAG,CAACG,IAAI,KAAK,SAAS,EAAE;IAC/D,MAAM,IAAID,SAAS,CAAE,GAAEL,KAAK,CAACO,IAAI,CAAC,MAAM,CAAE,wEAAuE,CAAC;EACtH;EACA,IAAIJ,GAAG,CAACO,SAAS,IAAID,KAAK,KAAK,SAAS,IAAIN,GAAG,CAACG,IAAI,KAAK,SAAS,EAAE;IAChE,MAAM,IAAID,SAAS,CAAE,GAAEL,KAAK,CAACO,IAAI,CAAC,MAAM,CAAE,yEAAwE,CAAC;EACvH;AACJ,CAAC;AACD,MAAMI,YAAY,GAAGA,CAACT,GAAG,EAAEC,GAAG,EAAEM,KAAK,KAAK;EACtC,MAAMG,SAAS,GAAGV,GAAG,CAACW,UAAU,CAAC,IAAI,CAAC,IAClCX,GAAG,KAAK,KAAK,IACbA,GAAG,CAACW,UAAU,CAAC,OAAO,CAAC,IACvB,oBAAoB,CAACC,IAAI,CAACZ,GAAG,CAAC;EAClC,IAAIU,SAAS,EAAE;IACXX,kBAAkB,CAACC,GAAG,EAAEC,GAAG,CAAC;EAChC,CAAC,MACI;IACDK,mBAAmB,CAACN,GAAG,EAAEC,GAAG,EAAEM,KAAK,CAAC;EACxC;AACJ,CAAC;AACD,eAAeE,YAAY"},"metadata":{},"sourceType":"module","externalDependencies":[]}