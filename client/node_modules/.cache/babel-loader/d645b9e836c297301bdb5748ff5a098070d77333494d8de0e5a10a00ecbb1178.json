{"ast":null,"code":"import { compactVerify } from '../jws/compact/verify.js';\nimport jwtPayload from '../lib/jwt_claims_set.js';\nimport { JWTInvalid } from '../util/errors.js';\nexport async function jwtVerify(jwt, key, options) {\n  var _a;\n  const verified = await compactVerify(jwt, key, options);\n  if (((_a = verified.protectedHeader.crit) === null || _a === void 0 ? void 0 : _a.includes('b64')) && verified.protectedHeader.b64 === false) {\n    throw new JWTInvalid('JWTs MUST NOT use unencoded payload');\n  }\n  const payload = jwtPayload(verified.protectedHeader, verified.payload, options);\n  const result = {\n    payload,\n    protectedHeader: verified.protectedHeader\n  };\n  if (typeof key === 'function') {\n    return {\n      ...result,\n      key: verified.key\n    };\n  }\n  return result;\n}","map":{"version":3,"names":["compactVerify","jwtPayload","JWTInvalid","jwtVerify","jwt","key","options","_a","verified","protectedHeader","crit","includes","b64","payload","result"],"sources":["C:/Users/rama_/Desktop/vicky uni/Henrry Prep Course/otrom2/Brainly-Front/client/node_modules/jose/dist/browser/jwt/verify.js"],"sourcesContent":["import { compactVerify } from '../jws/compact/verify.js';\nimport jwtPayload from '../lib/jwt_claims_set.js';\nimport { JWTInvalid } from '../util/errors.js';\nexport async function jwtVerify(jwt, key, options) {\n    var _a;\n    const verified = await compactVerify(jwt, key, options);\n    if (((_a = verified.protectedHeader.crit) === null || _a === void 0 ? void 0 : _a.includes('b64')) && verified.protectedHeader.b64 === false) {\n        throw new JWTInvalid('JWTs MUST NOT use unencoded payload');\n    }\n    const payload = jwtPayload(verified.protectedHeader, verified.payload, options);\n    const result = { payload, protectedHeader: verified.protectedHeader };\n    if (typeof key === 'function') {\n        return { ...result, key: verified.key };\n    }\n    return result;\n}\n"],"mappings":"AAAA,SAASA,aAAa,QAAQ,0BAA0B;AACxD,OAAOC,UAAU,MAAM,0BAA0B;AACjD,SAASC,UAAU,QAAQ,mBAAmB;AAC9C,OAAO,eAAeC,SAASA,CAACC,GAAG,EAAEC,GAAG,EAAEC,OAAO,EAAE;EAC/C,IAAIC,EAAE;EACN,MAAMC,QAAQ,GAAG,MAAMR,aAAa,CAACI,GAAG,EAAEC,GAAG,EAAEC,OAAO,CAAC;EACvD,IAAI,CAAC,CAACC,EAAE,GAAGC,QAAQ,CAACC,eAAe,CAACC,IAAI,MAAM,IAAI,IAAIH,EAAE,KAAK,KAAK,CAAC,GAAG,KAAK,CAAC,GAAGA,EAAE,CAACI,QAAQ,CAAC,KAAK,CAAC,KAAKH,QAAQ,CAACC,eAAe,CAACG,GAAG,KAAK,KAAK,EAAE;IAC1I,MAAM,IAAIV,UAAU,CAAC,qCAAqC,CAAC;EAC/D;EACA,MAAMW,OAAO,GAAGZ,UAAU,CAACO,QAAQ,CAACC,eAAe,EAAED,QAAQ,CAACK,OAAO,EAAEP,OAAO,CAAC;EAC/E,MAAMQ,MAAM,GAAG;IAAED,OAAO;IAAEJ,eAAe,EAAED,QAAQ,CAACC;EAAgB,CAAC;EACrE,IAAI,OAAOJ,GAAG,KAAK,UAAU,EAAE;IAC3B,OAAO;MAAE,GAAGS,MAAM;MAAET,GAAG,EAAEG,QAAQ,CAACH;IAAI,CAAC;EAC3C;EACA,OAAOS,MAAM;AACjB"},"metadata":{},"sourceType":"module","externalDependencies":[]}